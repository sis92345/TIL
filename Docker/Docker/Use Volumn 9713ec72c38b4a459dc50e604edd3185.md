# Use Volumn

Volumn은 Container에 Mounted된 host machine의 폴더이란걸 알았으니 이제 Voluumn을 사용하는 방법에 대해 알아보자

# Volumn은 Container의 폴더가 아닌 다른 디바이스이다.

Volumn으로 데이터를 작업시 **Volumn으로 데이터를 옮기는 것은 실제로 Container 내부의 다른 폴더로 이동시키는게 아니라 컨테이너 외부로 데이터를 옮기는 것이다.**

따라서 아래 코드는 오류를 발생시킨다.

```docker
await fs.rename(tempFilePath, finalFilePath);
```

rename은 동일한 디바이스에서 처리되는 명령어이다. 따라서 Volumn은 다른 디바이스이므로 이 명령어를 사용하면 오류가 발생한다.

```docker
(node:1) UnhandledPromiseRejectionWarning: Error: EXDEV: cross-device link not permitted, rename '/app/temp/test.txt' -> '/app/feedback/test.txt'

```

따라서 copyFile 같은 디바이스간 처리 명령어를 사용해서 해결한다.

# Dockerfile에서 Volumn을 사용하는 방법

Dockerfile에서는 익명 볼륨을 사용할 수 있다.

```docker
# WORKDIR이 /app 이므로 /app/feedback
# 익명 Volumn 정하기 [ "컨테이너 내부의 경로" ]
VOLUME [ "/app/feedback" ]
```

# `-v` 옵션을 사용한 Named Volumn 생성

> `docker run -v [”Volumn 이름”]:["컨테이너 내부의 경로"]`
예 : docker run -d -p 3000:80 --rm --name feedback-app -v feedback:/app/feedback feedback-node:volumns
> 

Named Valumn을 사용하므로 Container를  rm 후 볼륨을 지정한 후 재시작하면 데이터가 살아있는 것을 볼 수 있다.