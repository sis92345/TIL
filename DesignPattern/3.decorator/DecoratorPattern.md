# Decorator Pattern

# TL;DR

- **데코레이터의 슈퍼클래스는 자신이 장식하고 있는 객체의 슈퍼클래스와 같다**
- 한 객체를 여러 데코레이터로 감쌀 수 있다
- 데코레이터는 자신이 감싸고 있는 객체와 같은 슈퍼클래스를 가지고 있기에 원래 객체가 들어갈 자리에 데코레이터 객체를 넣어도 상관이 없다.
- **데코레이터는 자신이 장식하고 있는 객체에게 어떤 행동을 위임하는 일 말고도 추가 작업을 수행할 수 있다.**
- 객체는 언제든지 감쌀 수 있으므로 실행 중에 필요한 데코레이터를 마음대로 적용할 수 있다.
- 데코레이터 패턴은 예제처럼 추상 Component로 돌아가는 코드에 적합하다. 만약 Field로 구성되어 있는 코드에 데코레이터 패턴을 사용한다면 문제가 발생한다.
  - 즉 객체를 확장하는 용도의 데코레이터는 적합하지만, 값을 Field로 어떤 값을 처리할 필요가 있는 객체에 데코레이터를 적용하면 오히려 제대로 작동하지 않는다 : Whip으로 감싼 Beverage는 deCaf ? Espresso? -> whip으로 데코레이트한 Beverage에 Espresso 특별 할인이 적용된다면?
- 보통 Decorate 패턴을 사용할 때 펙토리 패턴이나 빌더 같은 패턴으로 많이 사용한다.
- Decorator Pattern으로 디자인된 대표적인 Class가 자바 I/O

# 1. 데코레이터 패턴이란

상속은 강력하지만, 상속을 사용한다고 해서 반드시 유연하거나 관리하기 쉬운 디자인 패턴을 만들 수 없다. 서브 클래스는 컴파일 단계에서 클래스의 행동이 결정되므로 모든 서브 클래스는 동일한 행동을 상속받아야 한다. **하지만 구성으로 객체의 행동을 확장한다면, 실행 중에 동적으로 행동을 설정할 수 있다.** 즉 객체를 동적으로 구성하면 기존 코드를 고치는 것이 아닌, 기존의 코드를 건드리지 않고 새로운 코드를 만들어서 기능을 추가할 수 있다. 

**데코레이터 페턴이란 객체에 추가 요소를 동적으로 더할 수 있다**. 데코레이터를 사용하면 서브클래스를 만들 때보다 훨씬 유용하게 기능을 확장할 수 있다.

# 2. 디자인 원칙 3 : OCP

OCP : Open-closed Principle 

클래스는 확장에는 열려 있어야 하지만, 변경에는 닫혀 있어야 한다.

단 무조건 OCP를 적용한다면, 괜히 쓸데없는 일을 하며 시간을 낭비할 수 있다. 따라서 적절한 케이스를 보며 중점적으로 OCP를 적용하는 방법이 좋다.

# 3. 데코레이터 패턴 살펴보기

예제의 badcase 페키지처럼 구성할 경우 클래스가 어마어마하게 많아질 것이다. 모든 음료에 대한 COST 계산, 그 COST에 대한 사이드 이펙트 계산까지 고려해야할 부분이 많다.

![스크린샷 2022-07-17 오후 7 26 04](https://user-images.githubusercontent.com/68282095/179394091-29d2e6cd-3b9a-4023-ac36-676b26692baa.png)

- Decorator : 각 데코레이터 안에는 Component 객체가 들어가 있다. 즉 데코레이터에는 Component의 인스턴스 변수가 존재한다. **Decorator는 자신이 장식할 Component와 같은 인터페이스 또는 추상 클래스를 구현한다.**
  - 구현된 Decorator는 Component의 상태를 확장할 수 있다. 또한 새로운 메소드를 추가할 수 있다.
- Concrete Component : 구현된 Component로 Decorator로 새로운 행동을 동적으로 추가한다.

따라서 위 음료 예제로 구현하면 아래와 같다.

- Beverage abstract class : Component
- DarkRoast, Decaf, Espresso : Concrete Component
- Whip, soy, milk, bean -> Beverage 인스턴스를 가지는 Decorator, Decorator라는 공통 클래스를 상속받고, Decorator 클래스는 Beverage를 상속받는다 ( <u>슈퍼클래스의 행동을 가져오려는 의도가 아니라 슈퍼클래스를 상속 받는 Component와 같은 인터페이스를 맞추기 위해 사용</u> )

